<html data-cast-api-enabled="true">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Codenames</title>

  <link rel="stylesheet" href="index.css">

</head>
<body>

  <div id="spoilerBtn" onclick="castBoard()">SPOILER</div>
  <div id="game"></div>

</body>
<script src="rijeci.js"></script>
<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="http://underscorejs.org/underscore-min.js"></script>
<script type="text/javascript"
        src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
<script src="chromecast.js"></script>
<script type="text/javascript">
var state = {
  nowPlaying: 'teamA',
  score: [0, 0],
  board: []
}

$(document).ready(function(){
  state.board = generateBoard(state.nowPlaying);
  var words = getRandomWords(rijeci, 25);

  $.each(words, function(i, word){
    $("#game").append('<div class="word ' + state.board[i] + '">' + word + '</div>');
  });

  $('#spoilerBtn').on('mouseenter mouseleave', function() {
    $('#game').toggleClass('spoiler');
  });

})

function generateBoard(first) {
  var teamA = first === 'teamA' ? 9 : 8;
  var teamB = first === 'teamB' ? 9 : 8;

  var board = new Array(25);
  board.fill('teamA', 0, teamA);
  board.fill('teamB', teamA, teamA+teamB);
  board.fill('neutral', teamA+teamB);
  board[board.length-1] = 'assasin';

  return shuffle(board);
}

function shuffle(words) {
  var replaced = [];
  var newArray = words.slice(0);
  for(var i = 0; i < words.length; i++) {
    var newIndex;

    do {
      newIndex = getRandomInt(0, words.length-1);
    } while(replaced.indexOf(newIndex) >= 0);

    replaced.push(newIndex);
    newArray[newIndex] = words[i];
  }

  return newArray;
}

function getRandomWords(words, n) {
  var rnd;
  var results = [];
  while(results.length < n) {
    rnd = getRandomInt(0, words.length);
    if(results.indexOf(words[rnd]) < 0) {
      results.push(words[rnd]);
    }
  }
  return results;
}

function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

</script>
</html>
